webpackJsonp([1],{"6DE0":function(e,t){},"8DL7":function(e,t){},AzPs:function(e,t){},KDoH:function(e,t){},LicG:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i("IvJb"),o={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var r=i("C7Lr")({name:"App"},o,!1,function(e){i("AzPs")},"data-v-1fa644c1",null).exports,a=i("KGCO"),l=i("DVuL"),n=i.n(l),u=(i("LicG"),i("6DE0"),i("aozt")),d=i.n(u),c={getAxio:function(e,t){return d()({url:e,method:"post",data:t}).then(function(e){return e.data})},postAxio:function(e){return d()({url:e,method:"get"}).then(function(e){return e.data})},test:""},p=i("3cXf"),m=i.n(p),g={data:function(){return{checked:!0,ruleForm:{username:"",password:""},rules:{username:[{trigger:"blur",required:!0,message:"请输入账号"}],password:[{trigger:"blur",required:!0,message:"请输入密码"}]},loading:!1}},mounted:function(){this.$nextTick(function(){localStorage.getItem("password")&&(this.ruleForm=JSON.parse(localStorage.getItem("password")))})},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0;var i={username:t.ruleForm.username,pwd:t.ruleForm.password};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Login/userLogin.html",i).then(function(e){t.loading=!1,1==e.status?(t.checked?localStorage.setItem("password",m()(t.ruleForm)):localStorage.getItem("password")&&localStorage.removeItem("password"),sessionStorage.removeItem("name"),t.$router.push({name:"configure",path:"/configure"})):t.$message.error(e.msg)})})}}},h={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"60px","status-icon":"",rules:e.rules}},[i("h3",{staticClass:"title"},[e._v("微信开发者后台")]),e._v(" "),i("el-form-item",{attrs:{label:"账号",prop:"username"}},[i("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"密码",prop:"password"}},[i("el-input",{attrs:{type:"password"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.submitForm("ruleForm")}},model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1),e._v(" "),i("el-form-item",[i("el-checkbox",{model:{value:e.checked,callback:function(t){e.checked=t},expression:"checked"}},[e._v("记住密码")])],1),e._v(" "),i("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("登录")])],1)},staticRenderFns:[]};var f=i("C7Lr")(g,h,!1,function(e){i("VmZT")},"data-v-5aefa4f0",null).exports,v={data:function(){return{router:!0,isCollapse:!1,collapseTransition:!0,width:"200px",activeIndex:"configure",username:"",nowPublic:"",icon:"el-icon-d-arrow-left",logo:"微信开发者后台"}},mounted:function(){this.$nextTick(function(){localStorage.getItem("password")?this.username=JSON.parse(localStorage.getItem("password")).username:this.$router.push({name:"login",path:"/login"})})},methods:{change:function(){this.isCollapse?(this.width="200px",this.icon="el-icon-d-arrow-left",this.logo="微信开发者后台"):(this.width="64px",this.icon="el-icon-d-arrow-right",this.logo="微信"),this.isCollapse=!this.isCollapse},loginOut:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Login/logout.html").then(function(t){1==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},getnowPublic:function(e){this.nowPublic=e},getactiveIndex:function(e){this.activeIndex=e}}},b={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-container",[i("el-header",[i("el-col",{staticClass:"header"},[i("el-col",{staticClass:"logo",style:{width:e.width},attrs:{span:4}},[e._v(e._s(e.logo))]),e._v(" "),i("el-col",{attrs:{span:10}},[i("div",{staticClass:"tools",on:{click:e.change}},[i("i",{class:e.icon})]),e._v(" "),i("div",{staticClass:"nowPublic"},[e._v("\n            当前公众号 : "),i("span",[e._v(e._s(e.nowPublic))])])]),e._v(" "),i("el-col",{staticClass:"information",attrs:{span:3}},[i("el-dropdown",{staticStyle:{cursor:"pointer"},attrs:{trigger:"click"}},[i("span",{staticClass:"el-dropdown-link"},[e._v("\n\t\t\t\t\t\t    "+e._s(e.username)),i("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),i("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[i("el-dropdown-item",{nativeOn:{click:function(t){return e.loginOut(t)}}},[e._v("\n                退出登录\n              ")])],1)],1)],1)],1)],1),e._v(" "),i("el-container",{staticClass:"main-container"},[i("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{collapse:e.isCollapse,router:e.router,"collapse-transition":e.collapseTransition,"default-active":e.activeIndex,"active-text-color":"#fff"}},[i("el-submenu",{attrs:{index:"1"}},[i("template",{slot:"title"},[i("i",{staticClass:"el-icon-setting"}),e._v(" "),i("span",[e._v("公众号管理")])]),e._v(" "),i("el-menu-item-group",[i("el-menu-item",{attrs:{index:"configure"}},[e._v("公众号配置")]),e._v(" "),i("el-menu-item",{attrs:{index:"menu"}},[e._v("菜单栏")]),e._v(" "),i("el-menu-item",{attrs:{index:"autoReply"}},[e._v("自动回复")])],1)],2),e._v(" "),i("el-submenu",{attrs:{index:"2"}},[i("template",{slot:"title"},[i("i",{staticClass:"el-icon-menu"}),e._v(" "),i("span",[e._v("系统管理")])]),e._v(" "),i("el-menu-item-group",[i("el-menu-item",{attrs:{index:"systemUser"}},[e._v("系统用户")]),e._v(" "),i("el-menu-item",{attrs:{index:"roleManage"}},[e._v("角色管理")])],1)],2),e._v(" "),i("el-menu-item",{attrs:{index:"customerService"}},[i("i",{staticClass:"el-icon-service"}),e._v(" "),i("span",{attrs:{slot:"title"},slot:"title"},[e._v("客服系统")])])],1),e._v(" "),i("el-main",[i("router-view",{on:{nowPublic:e.getnowPublic,activeIndex:e.getactiveIndex}})],1)],1)],1)},staticRenderFns:[]};var y={components:{Header:i("C7Lr")(v,b,!1,function(e){i("8DL7")},"data-v-71ff24b9",null).exports}},_={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"main"},[t("Header")],1)},staticRenderFns:[]};var w=i("C7Lr")(y,_,!1,function(e){i("gfrq")},"data-v-9ab2d262",null).exports,x={data:function(){return{publicConfig:[],loading:!0,loading2:!1,dialogVisible:!1,ruleForm:{wechatid:"",name:"",appid:"",appsecret:"",token:"",encodingaeskey:""},addOrEdit:-1,title:"添加公众号",rules:{wechatid:[{trigger:"blur",required:!0,message:"请输入微信号"}],name:[{trigger:"blur",required:!0,message:"请输入公众号名称"}],appid:[{trigger:"blur",required:!0,message:"请输入appid"}],appsecret:[{trigger:"blur",required:!0,message:"请输入appsecret"}],token:[{trigger:"blur",required:!0,message:"请输入token"}]}}},mounted:function(){this.$nextTick(function(){this.$emit("activeIndex","configure"),this.getconfigInfo()})},methods:{getMenu:function(){var e=this;this.$confirm("是否要从微信服务器拉取菜单").then(function(t){var i=e.$loading({text:"拼命拉取中..."});e.tools.getAxio("http://www.songphper.top"+e.tools.test+"/index/Wechat/getMenu.html").then(function(t){1==t.status?(e.getconfigInfo(),e.$message.success(t.msg)):2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg),i.close()})}).catch(function(e){})},use:function(e){var t=this;this.$confirm("是否切换到 "+e.name).then(function(i){var s={id:e.id};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Config/changeAccount.html",s).then(function(i){1==i.status?(t.$message.success(i.msg),t.getconfigInfo(),t.$emit("nowPublic",e.name),sessionStorage.setItem("name",e.name)):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})}).catch(function(e){})},add:function(e){this.dialogVisible=!0,-1!=e?(this.addOrEdit=e.id,this.title="编辑公众号",this.ruleForm=e,this.ruleForm={wechatid:e.wechatid,name:e.name,appid:e.appid,appsecret:e.appsecret,token:e.token,encodingaeskey:e.encodingaeskey}):(this.addOrEdit=-1,this.title="添加公众号",this.ruleForm={wechatid:"",name:"",appid:"",appsecret:"",token:"",encodingaeskey:""})},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(!i)return!1;t.loading2=!0;var s={name:t.ruleForm.name,appid:t.ruleForm.appid,appsecret:t.ruleForm.appsecret,token:t.ruleForm.token,encodingaeskey:t.ruleForm.encodingaeskey,wechatid:t.ruleForm.wechatid,id:t.addOrEdit};-1!=t.addOrEdit?(s.id=t.addOrEdit,t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Config/updateConfig.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getconfigInfo()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})):t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Config/addconfig.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getconfigInfo()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})})},getconfigInfo:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Config/index.html").then(function(t){if(e.loading=!1,1==t.status){var i=!0;e.publicConfig=t.configlist,e.publicConfig.forEach(function(t,s){1==t.status&&(e.$emit("nowPublic",t.name),sessionStorage.setItem("name",t.name),i=!1)}),i&&e.$emit("nowPublic","暂时没有哦")}else 2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},del:function(e){var t=this;this.$confirm("是否删除 "+e.name).then(function(i){var s={id:e.id};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Config/delConfig.html",s).then(function(e){1==e.status?(t.$message.success(e.msg),t.getconfigInfo()):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}).catch(function(e){})}}},k={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:function(t){e.add(-1)}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加公众号")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.publicConfig,border:""}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[i("el-form-item",{attrs:{label:"Appsecret："}},[i("span",[e._v(e._s(t.row.appsecret))])]),e._v(" "),i("el-form-item",{attrs:{label:"Encodingaeskey："}},[i("span",[e._v(e._s(t.row.encodingaeskey))])]),e._v(" "),i("el-form-item",{attrs:{label:"接口配置URL："}},[i("span",[e._v(e._s(t.row.url))])]),e._v(" "),i("el-form-item",{attrs:{label:"Token："}},[i("span",[e._v(e._s(t.row.token))])])],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{type:"index",width:"60",label:"ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"wechatid",label:"微信号",width:"180"}}),e._v(" "),i("el-table-column",{attrs:{prop:"name",label:"公众号名称",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"appid",label:"APPID",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"status",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?i("span",{staticClass:"active"},[e._v("使用中")]):i("span",{staticClass:"nactive"},[e._v("未使用")])]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.status?i("el-button",{attrs:{type:"info",size:"middle",disabled:""}},[e._v("使用")]):i("el-button",{attrs:{type:"primary",size:"middle"},on:{click:function(i){i.stopPropagation(),e.use(t.row)}}},[e._v("使用")]),e._v(" "),i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){i.stopPropagation(),e.add(t.row)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){i.stopPropagation(),e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})]),e._v(" "),1==t.row.status?i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:e.getMenu}},[e._v("重置数据")]):e._e()]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"640px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px","status-icon":""}},[i("el-form-item",{attrs:{label:"微信号",prop:"wechatid"}},[i("el-input",{model:{value:e.ruleForm.wechatid,callback:function(t){e.$set(e.ruleForm,"wechatid",t)},expression:"ruleForm.wechatid"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"公众号名称",prop:"name"}},[i("el-input",{model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Appid",prop:"appid"}},[i("el-input",{model:{value:e.ruleForm.appid,callback:function(t){e.$set(e.ruleForm,"appid",t)},expression:"ruleForm.appid"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Appsecret",prop:"appsecret"}},[i("el-input",{model:{value:e.ruleForm.appsecret,callback:function(t){e.$set(e.ruleForm,"appsecret",t)},expression:"ruleForm.appsecret"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Token",prop:"token"}},[i("el-input",{model:{value:e.ruleForm.token,callback:function(t){e.$set(e.ruleForm,"token",t)},expression:"ruleForm.token"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"Encodingaeskey",prop:"encodingaeskey"}},[i("el-input",{model:{value:e.ruleForm.encodingaeskey,callback:function(t){e.$set(e.ruleForm,"encodingaeskey",t)},expression:"ruleForm.encodingaeskey"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var F=i("C7Lr")(x,k,!1,function(e){i("X8XE")},"data-v-6033f829",null).exports,C={data:function(){var e=this,t=function(t,i,s){""===i?"2"==e.radio?s(new Error("请输入链接地址")):"4"==e.radio&&s(new Error("请输入小程序路径")):s()};return{loading:!0,loading2:!1,menuInfo:[],title:"添加一级菜单",dialogVisible:!1,radio:"1",isParent:-1,isEditParent:1,EditId:0,isParentText:"一级菜单",getRowKeys:function(e){return e.id},expands:[],restaurants:[],ruleForm:{buttonname:"",miniprogramurl:"",key:"",url:"",url2:"",url3:"",sort:"",imageText:""},rules:{buttonname:[{trigger:"change",required:!0,validator:function(t,i,s){var o=i.replace(/[^\x00-\xff]/g,"aa").length;""===i?s(new Error("请输入菜单名称")):-1==e.isParent&&o>8?s(new Error("一级菜单不能超过4个汉字或者8个字母或数字")):-1!=e.isParent&&o>16?s(new Error("子菜单不能超过8个汉字或者16个字母或数字")):s()}}],key:[{trigger:"blur",required:!0,message:"请输入小程序APPID"}],miniprogramurl:[{trigger:"blur",required:!0,message:"请输入网页地址"}],url2:[{trigger:"blur",required:!0,validator:t}],url:[{trigger:"blur",required:!0,validator:t}],imageText:[{trigger:"change",required:!0,message:"请选择跳转的图文"}]}}},mounted:function(){this.$nextTick(function(){this.$emit("activeIndex","menu"),this.getMenuInfo(),sessionStorage.getItem("name")?this.$emit("nowPublic",sessionStorage.getItem("name")):this.$emit("nowPublic","暂时没有哦")})},methods:{querySearch:function(e,t){var i=this.restaurants;t(e?i.filter(this.createFilter(e)):i)},createFilter:function(e){return function(t){return 0===t.title.toLowerCase().indexOf(e.toLowerCase())}},getImgText:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Wechat/getNews.html").then(function(t){1==t.status?0==t.list.length?e.$message.error("还没有发表过图文消息哦"):e.restaurants=t.list:2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},getRadio:function(e){3==e&&this.getImgText()},handleSelect:function(e){this.ruleForm.imageText=e.title,this.ruleForm.url3=e.media_id},expandChange:function(e){var t=this.expands.indexOf(e.id);t>-1?this.expands.splice(t,1):this.expands.push(e.id)},getMenuInfo:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Menu/index.html").then(function(t){e.loading=!1,1==t.status?(t.menulist.forEach(function(e,t){"view"==e.type?e.type="跳转网页":"show"==e.type?e.type="显示子菜单":"media_id"==e.type?e.type="跳转图文消息":"miniprogram"==e.type&&(e.type="跳转小程序"),e.chmenu.forEach(function(e,t){"view"==e.type?e.type="跳转网页":"show"==e.type?e.type="显示子菜单":"media_id"==e.type?e.type="跳转图文消息":"miniprogram"==e.type&&(e.type="跳转小程序")})}),e.menuInfo=t.menulist):2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},add:function(e,t){var i=this;if(this.EditId=0,this.dialogVisible=!0,this.ruleForm={buttonname:"",miniprogramurl:"",key:"",url:"",url2:"",url3:"",sort:"",imageText:""},-1==e?(this.isEditParent=1,this.isParent=-1,this.radio="1",this.isParentText="一级菜单",this.title="添加一级菜单"):(this.isEditParent=1,this.isParent=e.id,this.radio="2",this.isParentText="子菜单",this.title="添加"+e.buttonname+"下的子菜单"),void 0!=t){this.EditId=e.id,1==t?(this.title="编辑一级菜单",this.isParentText="一级菜单",this.isParent=-1,"显示子菜单"==e.type?this.isEditParent=-1:this.isEditParent=1):0==t&&(this.isEditParent=1,this.title="编辑"+e.buttonname,this.isParent=e.parentid);var s={id:e.id};this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Menu/getMenuInfo.html",s).then(function(e){1==e.status?(i.ruleForm=e.menuinfo,"show"==e.menuinfo.type?i.radio="1":"view"==e.menuinfo.type?(i.radio="2",i.ruleForm.url2="",i.ruleForm.url3="",i.ruleForm.key="",i.ruleForm.imageText=""):"media_id"==e.menuinfo.type?(i.radio="3",i.ruleForm={buttonname:e.menuinfo.buttonname,miniprogramurl:"",key:"",url:"",url2:"",url3:e.menuinfo.media_id,sort:e.menuinfo.sort,imageText:e.menuinfo.key},i.getImgText()):"miniprogram"==e.menuinfo.type&&(i.radio="4",i.ruleForm.url2=e.menuinfo.url,i.ruleForm.url="",i.ruleForm.url3="",i.ruleForm.imageText="")):2==e.status?i.$router.push({name:"login",path:"/login"}):i.$message.error(e.msg)})}},del:function(e){var t=this,i={id:e.id};this.$confirm("是否删除 "+e.buttonname).then(function(e){t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Menu/delMenu.html",i).then(function(e){1==e.status?(t.getMenuInfo(),t.$message.success(e.msg)):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}).catch(function(e){})},putMenu:function(){var e=this;this.$confirm("是否要把本地菜单推送到微信服务器").then(function(t){var i=e.$loading({text:"拼命推送中..."});e.tools.getAxio("http://www.songphper.top"+e.tools.test+"/index/Wechat/createMenu.html").then(function(t){1==t.status?e.$message.success(t.msg):2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg),i.close()})}).catch(function(e){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(!i)return!1;t.loading2=!0;var s={buttonname:t.ruleForm.buttonname,sort:t.ruleForm.sort,status:1};-1==t.isParent?(0!=t.EditId&&(s.id=t.EditId),s.parentid=0,1==t.radio?s.type="show":2==t.radio?(s.type="view",s.url=t.ruleForm.url):3==t.radio?(s.type="media_id",s.url=t.ruleForm.url3,s.key=t.ruleForm.imageText):4==t.radio&&(s.type="miniprogram",s.url=t.ruleForm.url2,s.key=t.ruleForm.key,s.miniprogramurl=t.ruleForm.miniprogramurl),0==t.EditId?t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Menu/addMenu.html",s).then(function(i){t.loading2=!1,1==i.status?(t.getMenuInfo(),t.$message.success(i.msg),t.dialogVisible=!1,t.$refs[e].resetFields()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)}):t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Menu/editMenu.html",s).then(function(i){t.loading2=!1,1==i.status?(t.getMenuInfo(),t.$message.success(i.msg),t.dialogVisible=!1,t.$refs[e].resetFields()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})):(s.parentid=t.isParent,0!=t.EditId&&(s.id=t.EditId),2==t.radio?(s.type="view",s.url=t.ruleForm.url):3==t.radio?(s.type="media_id",s.url=t.ruleForm.url3,s.key=t.ruleForm.imageText):4==t.radio&&(s.type="miniprogram",s.url=t.ruleForm.url2,s.key=t.ruleForm.key,s.miniprogramurl=t.ruleForm.miniprogramurl),0==t.EditId?t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Menu/addMenu.html",s).then(function(i){t.loading2=!1,1==i.status?(t.getMenuInfo(),t.$message.success(i.msg),t.dialogVisible=!1,t.$refs[e].resetFields()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)}):t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Menu/editMenu.html",s).then(function(i){t.loading2=!1,1==i.status?(t.getMenuInfo(),t.$message.success(i.msg),t.dialogVisible=!1,t.$refs[e].resetFields()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)}))})}}},$={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:function(t){e.add(-1)}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 一级菜单")]),e._v(" "),i("el-button",{staticClass:"addPublic",staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.putMenu}},[e._v("保存修改")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px","min-width":"1160px"},attrs:{data:e.menuInfo,"row-key":e.getRowKeys,"expand-row-keys":e.expands},on:{"expand-change":e.expandChange}},[i("el-table-column",{attrs:{type:"expand"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-table",{staticClass:"childrenMenu",attrs:{data:t.row.chmenu,"show-header":!1}},[i("el-table-column",{attrs:{type:"index",width:"58",label:"ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"buttonname",label:"菜单名",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"type",label:"功能",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){e.add(t.row,0)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})])]}}])})],1)]}}])}),e._v(" "),i("el-table-column",{attrs:{type:"index",width:"60",label:"ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"buttonname",label:"菜单名",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"type",label:"功能",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){e.add(t.row,1)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})]),e._v(" "),"显示子菜单"==t.row.type?i("el-button",{attrs:{type:"primary",size:"middle"},on:{click:function(i){e.add(t.row)}}},[i("i",{staticClass:"el-icon-plus"}),e._v("子菜单")]):e._e()]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"640px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px","status-icon":""}},[i("el-form-item",{attrs:{label:e.isParentText,prop:"buttonname"}},[i("el-input",{model:{value:e.ruleForm.buttonname,callback:function(t){e.$set(e.ruleForm,"buttonname",t)},expression:"ruleForm.buttonname"}})],1),e._v(" "),1==e.isEditParent?i("el-form-item",{attrs:{label:"菜单功能"}},[i("el-radio-group",{attrs:{size:"mini"},on:{change:e.getRadio},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[-1==e.isParent?i("el-radio",{attrs:{border:"",label:"1"}},[e._v("显示子菜单")]):e._e(),e._v(" "),i("el-radio",{attrs:{border:"",label:"2"}},[e._v("跳转网页")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3"}},[e._v("跳转图文消息")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"4"}},[e._v("跳转小程序")])],1)],1):e._e(),e._v(" "),1==e.isEditParent?i("div",[1==e.radio?i("div"):2==e.radio?i("div",[i("el-form-item",{key:"1",attrs:{label:"链接地址",prop:"url"}},[i("el-input",{model:{value:e.ruleForm.url,callback:function(t){e.$set(e.ruleForm,"url",t)},expression:"ruleForm.url"}})],1)],1):3==e.radio?i("div",[i("el-form-item",{key:"2",attrs:{label:"选择图文列表",prop:"imageText"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入内容"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.item;return[i("div",{staticClass:"title"},[e._v(e._s(s.title))])]}}]),model:{value:e.ruleForm.imageText,callback:function(t){e.$set(e.ruleForm,"imageText",t)},expression:"ruleForm.imageText"}})],1)],1):4==e.radio?i("div",[i("el-form-item",{key:"3",attrs:{label:"小程序APPID",prop:"key"}},[i("el-input",{model:{value:e.ruleForm.key,callback:function(t){e.$set(e.ruleForm,"key",t)},expression:"ruleForm.key"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"小程序路径",prop:"url2"}},[i("el-input",{model:{value:e.ruleForm.url2,callback:function(t){e.$set(e.ruleForm,"url2",t)},expression:"ruleForm.url2"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"网页地址",prop:"miniprogramurl"}},[i("el-input",{model:{value:e.ruleForm.miniprogramurl,callback:function(t){e.$set(e.ruleForm,"miniprogramurl",t)},expression:"ruleForm.miniprogramurl"}})],1)],1):e._e()]):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"排序"}},[i("el-input",{model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}})],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var I=i("C7Lr")(C,$,!1,function(e){i("KDoH")},"data-v-d0f125ce",null).exports,T={data:function(){return{restaurants:[],autoReplay:[],loading:!0,loading2:!1,radio:"1",replyRadio:"1",timeRadio:"1",dialogVisible:!1,dialogqrCode:!1,dialogLibrary:!1,currentPage:1,pageList:null,total:0,total2:0,currentPage2:1,qrCodeInfo:{},qrCodeTitle:"",save:"保 存",title:"",addOrEdit:-1,codeType:0,expire:30,fileList:[],uploadUrl:"http://www.songphper.top"+this.tools.test+"/index/Wechat/uploadMatrial",media_id:null,newsData:null,ruleForm:{keyword:"",reply:"",imageText:""},rules:{keyword:[{trigger:"blur",required:!0,message:"请输入关键字"}],reply:[{trigger:"blur",required:!0,message:"请输入回复内容"}],imageText:[{trigger:"change",required:!0,message:"请选择回复的图文"}]}}},watch:{expire:{handler:function(e){e=String(e);this.expire=e.replace(/[^\d]/g,""),e>30?this.expire=30:e<0&&(this.expire=1)},deep:!0}},methods:{querySearch:function(e,t){var i=this.restaurants;t(e?i.filter(this.createFilter(e)):i)},createFilter:function(e){return function(t){return 0===t.title.toLowerCase().indexOf(e.toLowerCase())}},getRadio:function(e){if(3==e){this.getPage({type:"news",limit:50,page:1})}},handleSelect:function(e){this.ruleForm.imageText=e.title,this.newsdata=e.newsdata},expandChange:function(e){var t=this.expands.indexOf(e.id);t>-1?this.expands.splice(t,1):this.expands.push(e.id)},lookqrCode:function(e){this.dialogqrCode=!0,this.qrCodeInfo={},this.qrCodeTitle=e.keyword+"对应的二维码","扫码回复"==e.eventtype&&(0==e.expire?e.codetype="永久二维码":e.codetype="临时二维码"),this.qrCodeInfo=e},lookImgUrl:function(e){var t=this;this.qrCodeInfo={},this.qrCodeTitle="图片显示";var i={media_id:e.reply};this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Imgmaterial/getImageUrl",i).then(function(e){1==e.status?(t.dialogqrCode=!0,t.qrCodeInfo={imgurl:e.url,codetype:null}):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},changeVal:function(){""==this.expire&&(this.expire=30)},changeReplyRadio:function(e){this.save=2==e?"生成二维码":"保 存",-1!=this.addOrEdit&&(this.codeType=1==e?0:1)},getReplyInfo:function(e){var t=this,i={page:e,limit:10};this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Autoreply/index.html",i).then(function(e){t.loading=!1,1==e.status?(t.total2=e.count,e.replylist.forEach(function(e,t){"text"==e.msgtype?e.msgtype="文字":"image"==e.msgtype?e.msgtype="图片":"news"==e.msgtype&&(e.msgtype="图文"),1==e.eventtype?"DEFAULT_REPLY"==e.keyword?e.eventtype="默认回复":e.eventtype="关键字回复":13==e.eventtype?e.eventtype="扫码回复":11==e.eventtype&&(e.eventtype="欢迎语")}),t.autoReplay=e.replylist):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},filterTag:function(e,t){return t.eventtype===e},del:function(e){var t=this;this.$confirm("是否删除 "+e.keyword+" 这个关键字").then(function(i){var s={id:e.id};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Autoreply/delReply.html",s).then(function(e){1==e.status?(t.$message.success(e.msg),t.getReplyInfo(1)):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}).catch(function(e){})},add:function(e){var t=this;if(this.fileList=[],this.media_id=null,this.dialogVisible=!0,-1==e)this.addOrEdit=-1,this.title="添加自动回复",this.codeType=0,this.ruleForm={keyword:"",reply:""},this.expire=30,this.replyRadio="1",this.timeRadio="1",this.radio="1",this.save="保 存";else{this.addOrEdit=e.id,this.title="编辑自动回复";var i={id:e.id};this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Autoreply/getReplyInfo.html",i).then(function(e){if(1==e.status){if("text"==e.replyinfo.msgtype)t.radio="1";else if("image"==e.replyinfo.msgtype)t.radio="2",t.fileList=[{name:"图片",url:e.replyinfo.local_imgurl}],t.media_id=e.replyinfo.reply;else if("news"==e.replyinfo.msgtype){t.ruleForm={keyword:e.replyinfo.keyword,reply:e.replyinfo.reply,imageText:e.replyinfo.remark},t.newsdata=e.replyinfo.reply,t.radio="3";t.getPage({type:"news",limit:50,page:1})}t.codeType=0,1==e.replyinfo.eventtype?"DEFAULT_REPLY"==e.replyinfo.keyword?t.replyRadio="4":t.replyRadio="1":13==e.replyinfo.eventtype?(1==e.replyinfo.qrtype?(t.timeRadio="2",t.expire=e.replyinfo.expire):(t.timeRadio="1",t.expire=0),t.replyRadio="2",t.codeType=1):11==e.replyinfo.eventtype&&(t.replyRadio="3"),"news"!=e.replyinfo.msgtype&&(t.ruleForm=e.replyinfo)}else 2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(!i)return!1;if(2==t.radio&&null==t.media_id)t.$message.error("请选取回复图片");else{t.loading2=!0;var s={keyword:t.ruleForm.keyword,status:1};if(1==t.radio?(s.msgtype="text",s.reply=t.ruleForm.reply):2==t.radio?(s.msgtype="image",s.reply=t.media_id):3==t.radio&&(s.msgtype="news",s.reply=t.newsdata,s.remark=t.ruleForm.imageText),1==t.replyRadio?s.eventtype=1:2==t.replyRadio?(s.eventtype=13,1==t.timeRadio?(s.expire=0,s.qrtype=2):2==t.timeRadio&&(s.expire=t.expire,s.qrtype=1)):3==t.replyRadio?s.eventtype=11:4==t.replyRadio&&(s.eventtype=1,s.keyword="DEFAULT_REPLY"),-1==t.addOrEdit)if(2==t.replyRadio){var o={keyword:t.ruleForm.keyword};1==t.timeRadio?(o.expire=0,o.qrtype=2):2==t.timeRadio&&(o.expire=t.expire,o.qrtype=1),t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Wechat/createQRcode.html",o).then(function(i){1==i.status?(s.imgurl=i.imgurl,t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Autoreply/addReply.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.getReplyInfo(1),t.$refs[e].resetFields(),t.dialogVisible=!1,t.qrCodeTitle=s.keyword+"对应的二维码",t.dialogqrCode=!0,13==s.eventtype&&(0==s.expire?s.codetype="永久二维码":(s.codetype="临时二维码",s.endtime=i.info.endtime)),t.qrCodeInfo=s):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})}else t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Autoreply/addReply.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.getReplyInfo(1),t.$refs[e].resetFields(),t.dialogVisible=!1):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)});else s.id=t.addOrEdit,2==t.replyRadio&&(1==t.timeRadio?(s.expire=0,s.qrtype=2):2==t.timeRadio&&(s.expire=t.expire,s.qrtype=1)),t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Autoreply/editReply.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.getReplyInfo(1),t.$refs[e].resetFields(),t.dialogVisible=!1):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})}})},handleCurrentChange:function(e){var t={limit:20,page:e};this.getAllImg(t)},handleCurrentChange2:function(e){this.getReplyInfo(e)},fileSuccess:function(e,t,i){0==e.status?this.$message.error(e.msg):(this.fileList=[{name:t.name,url:t.url}],this.media_id=e.info.media_id)},fileError:function(e,t,i){this.$message.error("图片上传失败,请重试")},fileRemove:function(e,t){this.fileList=[],this.media_id=null},getForeverForLibrary:function(){this.dialogLibrary=!0;this.getAllImg({limit:20,page:1})},getAllImg:function(e){var t=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Imgmaterial/getAllImg",e).then(function(e){1==e.status?(t.total=e.count,t.pageList=e.list,0==e.list.length&&t.$message.error("图片库暂无素材~")):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error("图发太多了，微信不让，明天再斗吧")})},getPage:function(e){var t=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Wechat/getForeverForLibrary",e).then(function(e){1==e.status?(t.restaurants=e.list,0==e.list.length&&t.$message.error("还没有发表过图文消息哦~")):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},chooseImg:function(e){this.dialogLibrary=!1,this.fileList=[{name:"图片",url:e.local_imgurl}],this.media_id=e.media_id}},mounted:function(){this.$nextTick(function(){this.$emit("activeIndex","autoReply"),this.getReplyInfo(1),sessionStorage.getItem("name")?this.$emit("nowPublic",sessionStorage.getItem("name")):this.$emit("nowPublic","暂时没有哦")})}},R={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:function(t){e.add(-1)}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加自动回复")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.autoReplay,border:""}},[i("el-table-column",{attrs:{type:"index",width:"60",label:"ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"keyword",label:"关键字",width:"100"}}),e._v(" "),i("el-table-column",{attrs:{prop:"reply",label:"回复内容",width:"400"},scopedSlots:e._u([{key:"default",fn:function(t){return["图文"==t.row.msgtype?i("div",[e._v("\n          "+e._s(t.row.remark)+"\n        ")]):i("div",[e._v("\n          "+e._s(t.row.reply)+"\n        ")])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"eventtype",label:"回复场景",width:"110",filters:[{text:"关键字回复",value:"关键字回复"},{text:"扫码回复",value:"扫码回复"},{text:"欢迎语",value:"欢迎语"},{text:"默认回复",value:"默认回复"}],"filter-method":e.filterTag,"filter-placement":"bottom-end"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",[e._v(e._s(t.row.eventtype))])]}}])}),e._v(" "),i("el-table-column",{attrs:{prop:"msgtype",label:"回复类型",width:"80"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){i.stopPropagation(),e.add(t.row)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){i.stopPropagation(),e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})]),e._v(" "),"扫码回复"==t.row.eventtype?i("el-button",{attrs:{slot:"reference",type:"primary",size:"middle"},on:{click:function(i){i.stopPropagation(),e.lookqrCode(t.row)}},slot:"reference"},[i("i",{staticClass:"el-icon-search"}),e._v("二维码")]):e._e(),e._v(" "),"图片"==t.row.msgtype?i("el-button",{attrs:{slot:"reference",type:"primary",size:"middle"},on:{click:function(i){i.stopPropagation(),e.lookImgUrl(t.row)}},slot:"reference"},[i("i",{staticClass:"el-icon-search"}),e._v("图片")]):e._e()]}}])})],1),e._v(" "),i("el-pagination",{attrs:{"current-page":e.currentPage2,"page-size":10,layout:"total, prev, pager,jumper, next",total:e.total2,background:""},on:{"current-change":e.handleCurrentChange2,"update:currentPage":function(t){e.currentPage2=t}}}),e._v(" "),i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"640px",top:"8vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px","status-icon":""}},[i("el-form-item",{attrs:{label:"回复场景"}},[i("el-radio-group",{attrs:{size:"mini"},on:{change:e.changeReplyRadio},model:{value:e.replyRadio,callback:function(t){e.replyRadio=t},expression:"replyRadio"}},[i("el-radio",{attrs:{border:"",label:"1"}},[e._v("关键字回复")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2"}},[e._v("扫码回复")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3"}},[e._v("欢迎语")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"4"}},[e._v("默认回复")])],1)],1),e._v(" "),0==e.codeType?i("div",[i("div",{staticStyle:{overflow:"hidden"}},[i("el-col",{attrs:{span:15}},[2==e.replyRadio?i("el-form-item",{attrs:{label:"二维码类型"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.timeRadio,callback:function(t){e.timeRadio=t},expression:"timeRadio"}},[i("el-radio",{attrs:{border:"",label:"1"}},[e._v("永久二维码")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2"}},[e._v("临时二维码")])],1)],1):e._e()],1),e._v(" "),i("el-col",{attrs:{span:9}},[2==e.timeRadio&&2==e.replyRadio?i("div",{staticStyle:{width:"150px","margin-top":"5px"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"临时二维码最长有效期30天",placement:"bottom"}},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.expire,expression:"expire"}],staticClass:"nativeInput",domProps:{value:e.expire},on:{blur:e.changeVal,input:function(t){t.target.composing||(e.expire=t.target.value)}}})]),e._v(" "),i("span",[e._v("天后失效")])],1):e._e()])],1),e._v(" "),3!=e.replyRadio&&4!=e.replyRadio?i("el-form-item",{attrs:{prop:"keyword",label:"关键字"}},[i("el-input",{model:{value:e.ruleForm.keyword,callback:function(t){e.$set(e.ruleForm,"keyword",t)},expression:"ruleForm.keyword"}})],1):e._e()],1):i("div",[i("div",{staticStyle:{overflow:"hidden"}},[i("el-col",{attrs:{span:15}},[2==e.replyRadio?i("el-form-item",{attrs:{label:"二维码类型"}},[i("el-radio-group",{attrs:{size:"mini"},model:{value:e.timeRadio,callback:function(t){e.timeRadio=t},expression:"timeRadio"}},[i("el-radio",{attrs:{border:"",label:"1",disabled:""}},[e._v("永久二维码")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2",disabled:""}},[e._v("临时二维码")])],1)],1):e._e()],1),e._v(" "),i("el-col",{attrs:{span:9}},[2==e.timeRadio&&2==e.replyRadio?i("div",{staticStyle:{width:"150px","margin-top":"5px"}},[i("el-input",{attrs:{size:"small",disabled:!0},model:{value:e.expire,callback:function(t){e.expire=t},expression:"expire"}})],1):e._e()])],1),e._v(" "),3!=e.replyRadio&&4!=e.replyRadio?i("el-form-item",{attrs:{prop:"keyword",label:"关键字"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.keyword,callback:function(t){e.$set(e.ruleForm,"keyword",t)},expression:"ruleForm.keyword"}})],1):e._e()],1),e._v(" "),i("el-form-item",{attrs:{label:"回复类型"}},[-1==e.addOrEdit?i("el-radio-group",{attrs:{size:"mini"},on:{change:e.getRadio},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[i("el-radio",{attrs:{border:"",label:"1"}},[e._v("文字")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2"}},[e._v("图片")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3"}},[e._v("图文")])],1):i("el-radio-group",{attrs:{size:"mini"},on:{change:e.getRadio},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[1==e.radio?i("div",[i("el-radio",{attrs:{border:"",label:"1"}},[e._v("文字")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2",disabled:!0}},[e._v("图片")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3",disabled:!0}},[e._v("图文")])],1):2==e.radio?i("div",[i("el-radio",{attrs:{border:"",label:"1",disabled:!0}},[e._v("文字")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2"}},[e._v("图片")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3",disabled:!0}},[e._v("图文")])],1):3==e.radio?i("div",[i("el-radio",{attrs:{border:"",label:"1",disabled:!0}},[e._v("文字")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"2",disabled:!0}},[e._v("图片")]),e._v(" "),i("el-radio",{attrs:{border:"",label:"3"}},[e._v("图文")])],1):e._e()])],1),e._v(" "),1==e.radio?i("el-form-item",{key:"1",attrs:{prop:"reply",label:"回复内容"}},[i("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:12}},model:{value:e.ruleForm.reply,callback:function(t){e.$set(e.ruleForm,"reply",t)},expression:"ruleForm.reply"}})],1):e._e(),e._v(" "),2==e.radio?i("el-form-item",{key:"2",attrs:{label:"回复图片"}},[i("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"success"},on:{click:e.getForeverForLibrary}},[e._v("历史上传图片")]),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl,multiple:!1,"file-list":e.fileList,"list-type":"picture","on-success":e.fileSuccess,"on-error":e.fileError,drag:"","on-remove":e.fileRemove}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击上传")])])])],1):e._e(),e._v(" "),3==e.radio?i("el-form-item",{key:"3",attrs:{label:"选择图文列表",prop:"imageText"}},[i("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":e.querySearch,placeholder:"请输入内容"},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.item;return[i("div",{staticClass:"title"},[e._v(e._s(s.title))])]}}]),model:{value:e.ruleForm.imageText,callback:function(t){e.$set(e.ruleForm,"imageText",t)},expression:"ruleForm.imageText"}})],1):e._e()],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v(e._s(e.save))])],1)],1),e._v(" "),i("el-dialog",{attrs:{title:e.qrCodeTitle,visible:e.dialogqrCode,width:"280px"},on:{"update:visible":function(t){e.dialogqrCode=t}}},[i("img",{staticStyle:{width:"200px",height:"200px",display:"block",margin:"0 auto"},attrs:{src:e.qrCodeInfo.imgurl}}),e._v(" "),e.qrCodeInfo.codetype?i("span",{staticStyle:{"padding-right":"10px"}},[e._v(e._s(e.qrCodeInfo.codetype))]):e._e(),e._v(" "),e.qrCodeInfo.expire>0&&e.qrCodeInfo.codetype?i("span",{staticStyle:{color:"red",display:"block"}},[e._v("截止时间 :"+e._s(e.qrCodeInfo.endtime))]):e._e()]),e._v(" "),i("el-dialog",{attrs:{title:"图片素材库",visible:e.dialogLibrary,width:"700px",top:"8vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogLibrary=t}}},[i("div",{staticStyle:{overflow:"hidden"}},e._l(e.pageList,function(t){return i("img",{staticClass:"img ",attrs:{src:t.local_imgurl},on:{click:function(i){e.chooseImg(t)}}})})),e._v(" "),i("el-pagination",{staticStyle:{"margin-top":"0",float:"initial","text-align":"right"},attrs:{"current-page":e.currentPage,"page-size":20,layout:"total, prev, pager,jumper, next",total:e.total,background:""},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1)],1)},staticRenderFns:[]};var S=i("C7Lr")(T,R,!1,function(e){i("wOcD")},"data-v-942418ee",null).exports,P={data:function(){return{detailBox:!1,inputTelType:!1,userRecord:[{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"},{time:"6-14 11:00",record:"购买了XX商品"}],btnShow:!1,uploadUrl:"http://www.songphper.top"+this.tools.test+"/index/Wechat/uploadMatrial",cascaderType:!0,desc:"",fileList:[],fsType:!1,dialogbigImg:!1,uploadImg:!1,dialogLibrary:!1,currentPage:1,imgurl:null,userInfo:{},userInfoItem:[],userInfoDialog:!1,UserTagInfo:[],tagTotal:0,DialogInfo:[],textareaContent:"",link_wrap:!1,label_wrap:!1,addlabelType:!1,tip_wrap:!1,tip_content:"",globalOpenid:null,currentPage2:1,ruleForm:{content:"",link:""},ruleForm2:{InputUserTel:""},rules:{content:[{required:!0,message:"请输入文字内容",trigger:"blur"}],link:[{required:!0,message:"请输入链接接内容",trigger:"blur"}]},rules2:{InputUserTel:[{validator:function(e,t,i){""===t?i(new Error("请输入手机号")):/^1[3|4|5|6|8|7|9]\d{9}$/.test(t)?i():i(new Error("请输入正确格式的手机号"))},trigger:"blur"}]},media_id:"",total:0,pageList:[],fileUrl:"",selectedOptions:[],options:[],cascaderText:""}},methods:{detailBoxShow:function(){console.log(444),this.detailBox=!0},detailBoxhide:function(){this.detailBox=!1},searchTel:function(e){this.$refs[e].validate(function(e){})},inputFocus:function(){this.btnShow=!0},handleChange:function(e){var t=this;this.cascaderText="",this.options.forEach(function(i){e[0]==i.value&&(t.cascaderText+=i.label,e[1]&&(t.cascaderText+="/",i.children.forEach(function(i){e[1]==i.value&&(t.cascaderText+=i.label,e[2]&&(t.cascaderText+="/",i.children.forEach(function(i){e[2]==i.value&&(t.cascaderText+=i.label)})))})))}),this.cascaderType=!1},handleCurrentChange2:function(e){this.getUserTagInfo(this.globalOpenid,e,3)},showUserInfo:function(e){this.userInfoDialog=!0,this.btnShow=!1,this.getCustomerUserInfo(e),this.getUserTagInfo(e,1,3)},goBack:function(){this.cascaderType=!0},submitLabel:function(){var e={tagid:this.selectedOptions.join(","),openid:this.globalOpenid,remark:this.desc};this.addTag(e)},getForeverForLibrary:function(){this.dialogLibrary=!0;this.getAllImg({limit:20,page:1})},chooseImg:function(e){this.dialogLibrary=!1,this.fileList=[{name:"图片",url:e.local_imgurl}],this.media_id=e.media_id,this.fileUrl=e.local_imgurl},handleCurrentChange:function(e){var t={limit:20,page:e};this.getAllImg(t)},submitUpload:function(){if(""==this.media_id)this.$message.error("请选取回复图片");else{var e={content:"图片",openid:this.globalOpenid,msgtype:"image",media_id:this.media_id,url:this.fileUrl};this.postInitReply(e,"image")}},fileSuccess:function(e,t,i){0==e.status?this.$message.error(e.msg):(this.fileList=[{name:t.name,url:t.url}],this.media_id=e.info.media_id,this.fileUrl=e.info.url)},fileError:function(e,t,i){this.$message.error("图片上传失败,请重试")},fileRemove:function(e,t){this.fileList=[],this.media_id=null},chooseUser:function(e){this.userInfoItem.forEach(function(e,t){e.flag=!1}),e.flag=!0,e.status=1,this.getUserChatInfo(e.openid,e.headimgurl)},showBigImg:function(e){this.imgurl=e,this.dialogbigImg=!0},changeTextareaContent:function(){this.textareaContent.trim()&&(this.tip_wrap=!1)},submit:function(){if(this.textareaContent.trim()){var e={content:this.textareaContent,openid:this.globalOpenid};this.postInitReply(e,"text")}else this.tip_text="不能发送空白信息",this.tip_wrap=!0},addlink:function(){this.label_wrap=!1,this.addlabelType=!1,this.link_wrap?this.link_wrap=!1:this.link_wrap=!0},addlabel:function(){this.link_wrap=!1,this.label_wrap?(this.label_wrap=!1,this.addlabelType=!1):(this.label_wrap=!0,this.addlabelType=!0,this.getTag())},addPic:function(){this.uploadImg=!0},getCustomerUserInfo:function(e){var t=this;this.tools.postAxio("http://www.songphper.top"+this.tools.test+"/index/Customerinfo/getCustomerUserInfo?openid="+e).then(function(e){1==e.status?t.userInfo=e.data:2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},getUserTagInfo:function(e,t,i){var s=this,o={openid:e,page:t,limit:i};this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Customerinfo/getUserTagInfo",o).then(function(e){1==e.status?(s.UserTagInfo=e.data.user_tag_info,s.tagTotal=e.data.count):2==e.status?s.$router.push({name:"login",path:"/login"}):s.$message.error(e.msg)})},addTag:function(e){var t=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Tag/addTag",e).then(function(e){1==e.status?(t.cascaderType=!0,t.label_wrap=!1,t.addlabelType=!1,t.selectedOptions=[],t.desc="",t.$message.success(e.msg)):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},getTag:function(){var e=this;this.tools.postAxio("http://www.songphper.top"+this.tools.test+"/index/Tag/getTag").then(function(t){1==t.status?e.options=t.data:2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},getChatList:function(){var e=this;this.tools.postAxio("http://www.songphper.top"+this.tools.test+"/index/Kefu/getChatList").then(function(t){1==t.status?(t.data.forEach(function(e,t){e.flag=!1}),t.data[0].flag=!0,t.data[0].status=1,e.getUserChatInfo(t.data[0].openid,t.data[0].headimgurl),e.userInfoItem=t.data):2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},getUserChatInfo:function(e,t){var i=this;this.globalOpenid=e,this.tools.postAxio("http://www.songphper.top"+this.tools.test+"/index/Kefu/getUserChatInfo?openid="+e).then(function(e){1==e.status?(e.data.forEach(function(e,i){e.headimgurl=t}),i.DialogInfo=e.data,i.scrollBottom()):2==e.status?i.$router.push({name:"login",path:"/login"}):i.$message.error(e.msg)})},postInitReply:function(e,t){var i=this;this.fsType=!0,this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Wechat/initreply",e).then(function(s){if(i.fsType=!1,1==s.status){if("text"==t){var o={replytype:2,msgtype:"text",content:i.textareaContent};i.DialogInfo.push(o),i.textareaContent=""}else{var r={replytype:2,msgtype:"image",picurl:e.url};i.DialogInfo.push(r),i.fileList=[],i.uploadImg=!1,i.media_id="",i.fileUrl=""}i.scrollBottom()}else 2==s.status?i.$router.push({name:"login",path:"/login"}):i.$message.error(s.msg)})},scrollBottom:function(){var e=this;setTimeout(function(){var t=e.$refs.elscrollbar.$refs.wrap;t.scrollTop=t.scrollHeight},50)},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(i){var s='<a href="'+t.ruleForm.link+'">'+t.ruleForm.content+"</a>";t.textareaContent+=s,t.$refs[e].resetFields(),t.link_wrap=!1}})},getAllImg:function(e){var t=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Imgmaterial/getAllImg",e).then(function(e){1==e.status?(t.total=e.count,t.pageList=e.list,0==e.list.length&&t.$message.error("图片库暂无素材~")):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error("图发太多了，微信不让，明天再斗吧")})}},mounted:function(){var e=this;this.$nextTick(function(){e.getChatList(),e.$emit("activeIndex","customerService"),sessionStorage.getItem("name")?e.$emit("nowPublic",sessionStorage.getItem("name")):e.$emit("nowPublic","暂时没有哦")})}},E={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("div",{staticClass:"customerService"},[i("div",{staticClass:"left",staticStyle:{width:"210px"}},[i("el-scrollbar",{staticClass:"scrollbar"},[i("div",[e._l(e.userInfoItem,function(t){return i("div",{staticClass:"item",class:{active:t.flag},on:{click:function(i){e.chooseUser(t)}}},[1!=t.status?i("el-badge",{attrs:{"is-dot":""}},[i("img",{staticClass:"imgurl",attrs:{src:t.headimgurl}})]):i("img",{staticClass:"imgurl",attrs:{src:t.headimgurl}}),e._v(" "),i("div",{staticClass:"item-center"},[i("div",{staticClass:"name"},[e._v(e._s(t.nickname))]),e._v(" "),i("div",{staticClass:"lastquestion"},[e._v(e._s(t.content))])]),e._v(" "),i("div",{staticClass:"item_right"},[i("span",[e._v(e._s(t.time))]),e._v(" "),i("img",{attrs:{src:"static/image/label.png"}})])],1)}),e._v(" "),0==e.userInfoItem.length?i("div",{staticClass:"noUser"},[e._v("\n            暂时没有用户列表哦\n          ")]):e._e()],2)])],1),e._v(" "),i("el-col",{staticClass:"center",attrs:{span:18}},[i("div",{staticClass:"center_center"},[i("div",{staticClass:"record"},[i("el-scrollbar",{ref:"elscrollbar",staticStyle:{height:"100%"}},[i("div",{staticStyle:{padding:"30px"}},e._l(e.DialogInfo,function(t){return i("div",{staticStyle:{"margin-bottom":"20px"}},[1==t.replytype?i("div",{staticClass:"left_Dialog"},[i("img",{staticClass:"img",attrs:{src:t.headimgurl},on:{click:function(i){e.showUserInfo(t.openid)}}}),e._v(" "),"text"==t.msgtype?i("div",{staticClass:"send"},[i("div",{staticClass:"arrow"}),e._v(" "),i("pre",[e._v(e._s(t.content))])]):i("div",{staticClass:"img2_wrap"},[i("img",{staticClass:"img2",attrs:{src:t.picurl},on:{click:function(i){e.showBigImg(t.picurl)}}})])]):i("div",{staticClass:"right_Dialog"},[i("img",{staticClass:"img",attrs:{src:"static/image/logo.jpg"}}),e._v(" "),"text"==t.msgtype?i("div",{staticClass:"send"},[i("div",{staticClass:"arrow"}),e._v(" "),i("pre",[e._v(e._s(t.content))])]):i("div",{staticClass:"img2_wrap"},[i("img",{staticClass:"img2",attrs:{src:t.picurl},on:{click:function(i){e.showBigImg(t.picurl)}}})])])])}))]),e._v(" "),e.label_wrap?i("div",{staticClass:"label_wrap"},[i("el-cascader",{staticClass:"cascader",class:{active1:e.cascaderType},attrs:{options:e.options,filterable:!0,"expand-trigger":"hover"},on:{change:e.handleChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}}),e._v(" "),i("div",{staticClass:"cascaderTwo",class:{active2:!e.cascaderType}},[i("img",{attrs:{src:"static/image/back.png"},on:{click:e.goBack}}),e._v(" "),i("p",[e._v(e._s(e.cascaderText))]),e._v(" "),i("el-input",{attrs:{type:"textarea",autosize:{minRows:6,maxRows:6},placeholder:"可简述用户问题(选填)"},model:{value:e.desc,callback:function(t){e.desc=t},expression:"desc"}}),e._v(" "),i("el-button",{staticClass:"label_add",attrs:{type:"primary"},on:{click:e.submitLabel}},[e._v("完成")])],1)],1):e._e(),e._v(" "),e.link_wrap?i("div",{staticClass:"link_wrap"},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,inline:!0,"status-icon":""}},[i("el-form-item",{attrs:{label:"文字",prop:"content"}},[i("el-input",{model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"链接",prop:"link"}},[i("el-input",{model:{value:e.ruleForm.link,callback:function(t){e.$set(e.ruleForm,"link",t)},expression:"ruleForm.link"}})],1),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("立即生成")])],1)],1):e._e()],1)]),e._v(" "),i("div",{staticClass:"center_bottom"},[i("div",{staticClass:"toolsBar"},[i("img",{staticClass:"link",attrs:{src:"static/image/link.png"},on:{click:e.addlink}}),e._v(" "),i("img",{staticClass:"image",attrs:{src:"static/image/image.png"},on:{click:e.addPic}}),e._v(" "),i("img",{staticClass:"label",attrs:{src:e.addlabelType?"static/image/label.png":"static/image/label2.png"},on:{click:e.addlabel}})]),e._v(" "),i("div",{staticClass:"textarea_wrap"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:e.textareaContent,expression:"textareaContent"}],attrs:{autofocus:""},domProps:{value:e.textareaContent},on:{input:[function(t){t.target.composing||(e.textareaContent=t.target.value)},e.changeTextareaContent]}}),e._v(" "),i("el-button",{staticClass:"button",attrs:{size:"small",type:"success",loading:e.fsType},on:{click:e.submit}},[e._v("发送")]),e._v(" "),e.tip_wrap?i("div",{staticClass:"tip_wrap"},[i("img",{staticClass:"tip_img",attrs:{src:"static/image/tip.png"}}),e._v(" "),i("span",{staticClass:"tip_text"},[e._v(e._s(e.tip_text))])]):e._e()],1)])]),e._v(" "),i("el-col",{staticClass:"search",attrs:{span:6}},[e.inputTelType?i("div",{staticClass:"inputTelBefore"},[i("el-form",{ref:"ruleForm2",attrs:{model:e.ruleForm2,rules:e.rules2,"status-icon":""}},[i("el-form-item",{attrs:{label:"",prop:"InputUserTel"}},[i("el-input",{attrs:{type:"tel",maxlength:"11",placeholder:"请输入用户手机号"},model:{value:e.ruleForm2.InputUserTel,callback:function(t){e.$set(e.ruleForm2,"InputUserTel",t)},expression:"ruleForm2.InputUserTel"}})],1),e._v(" "),i("el-button",{staticClass:"btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchTel("ruleForm2")}}},[e._v("搜索")])],1)],1):i("div",{staticClass:"inputTelAfter"},[i("el-scrollbar",{staticClass:"scroll"},[i("div",{on:{mouseleave:e.detailBoxhide}},e._l(e.userRecord,function(t){return i("div",[i("div",{staticClass:"userRecord_item",on:{mouseenter:e.detailBoxShow}},[i("span",{staticClass:"time"},[e._v(e._s(t.time))]),e._v(" "),i("span",{staticClass:"record"},[e._v(e._s(t.record))])])])}))]),e._v(" "),e.detailBox?i("div",{staticClass:"detailBox"}):e._e()],1)])],1),e._v(" "),i("el-dialog",{attrs:{visible:e.dialogbigImg},on:{"update:visible":function(t){e.dialogbigImg=t}}},[i("img",{staticStyle:{height:"400px",margin:"0 auto",display:"block"},attrs:{src:e.imgurl}})]),e._v(" "),i("el-dialog",{attrs:{visible:e.uploadImg},on:{"update:visible":function(t){e.uploadImg=t}}},[i("el-button",{staticStyle:{float:"right","margin-top":"10px"},attrs:{type:"success"},on:{click:e.getForeverForLibrary}},[e._v("历史上传图片")]),e._v(" "),i("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:e.uploadUrl,"on-success":e.fileSuccess,"on-error":e.fileError,"file-list":e.fileList,"list-type":"picture","on-remove":e.fileRemove}},[i("i",{staticClass:"el-icon-upload"}),e._v(" "),i("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),i("em",[e._v("点击选取文件")])])]),e._v(" "),i("el-button",{staticStyle:{"margin-top":"10px"},attrs:{size:"small",type:"primary"},on:{click:e.submitUpload}},[e._v("回复图片")])],1),e._v(" "),i("el-dialog",{attrs:{title:"图片素材库",visible:e.dialogLibrary,width:"700px",top:"8vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogLibrary=t}}},[i("div",{staticStyle:{overflow:"hidden"}},e._l(e.pageList,function(t){return i("img",{staticClass:"img2",attrs:{src:t.local_imgurl},on:{click:function(i){e.chooseImg(t)}}})})),e._v(" "),i("el-pagination",{staticStyle:{"margin-top":"0",float:"initial","text-align":"right"},attrs:{"current-page":e.currentPage,"page-size":20,layout:"total, prev, pager,jumper, next",total:e.total,background:""},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}})],1),e._v(" "),i("el-dialog",{attrs:{visible:e.userInfoDialog,width:"340px",title:e.userInfo.nickname,"show-close":!1},on:{"update:visible":function(t){e.userInfoDialog=t}}},[i("div",{staticClass:"userItem"},[e._v("\n      手机号 \n      "),e.userInfo.telephone?i("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.telephone,expression:"userInfo.telephone"}],staticClass:"specInput",attrs:{value:"userInfo.telephone",type:"tel",maxlength:"11"},domProps:{value:e.userInfo.telephone},on:{focus:e.inputFocus,input:function(t){t.target.composing||e.$set(e.userInfo,"telephone",t.target.value)}}}):i("input",{directives:[{name:"model",rawName:"v-model",value:e.userInfo.telephone,expression:"userInfo.telephone"}],staticClass:"specInput",attrs:{value:"userInfo.telephone",type:"tel",maxlength:"11",placeholder:"请添加用户手机号"},domProps:{value:e.userInfo.telephone},on:{focus:e.inputFocus,input:function(t){t.target.composing||e.$set(e.userInfo,"telephone",t.target.value)}}}),e.btnShow?i("span",{staticClass:"userSave"},[e._v("保存")]):e._e(),e._v(" "),i("img",{staticClass:"headimgurl",attrs:{src:e.userInfo.headimgurl}})]),e._v(" "),i("div",{staticClass:"userItem",staticStyle:{"margin-bottom":"15px"}},[e._v("\n      地区      "+e._s(e.userInfo.country)+" "+e._s(e.userInfo.province)+" "+e._s(e.userInfo.city)+"\n    ")]),e._v(" "),i("hr"),e._v(" "),i("div",e._l(e.UserTagInfo,function(t){return i("div",[i("div",{staticStyle:{overflow:"hidden"}},[i("span",{staticStyle:{color:"#000","font-size":"40px",float:"left","border-radius":"50%"}},[e._v("·")]),i("span",{staticStyle:{color:"#000"}},[e._v(e._s(t.tagidstr))]),i("span",{staticStyle:{float:"right","font-size":"12px"}},[e._v("上周四")])]),e._v(" "),i("div",[i("span",{staticStyle:{"font-size":"13px","margin-left":"14px"}},[e._v(e._s(t.remark))])])])})),e._v(" "),i("el-pagination",{staticStyle:{float:"right"},attrs:{small:"",layout:"prev, pager, next",total:e.tagTotal,"current-page":e.currentPage2,"page-size":3},on:{"current-change":e.handleCurrentChange2,"update:currentPage":function(t){e.currentPage2=t}}})],1)],1)},staticRenderFns:[]};var A=i("C7Lr")(P,E,!1,function(e){i("asCa")},"data-v-399463b4",null).exports,L={data:function(){return{roleManage:[],allRules:[],loading:!0,loading2:!1,dialogVisible:!1,ruleForm:{title:"",rules:[]},addOrEdit:-1,title:"",rules:{title:[{trigger:"blur",required:!0,message:"请输入用户名"}]}}},methods:{getRoleManage:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Userauth/getAllRole.html").then(function(t){e.loading=!1,1==t.status?e.roleManage=t.rolelist:2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},getAllRules:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Userauth/getAllRules.html").then(function(t){1==t.status?e.allRules=t.rolelist:2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},add:function(e){this.dialogVisible=!0,-1!=e?(this.addOrEdit=e.id,this.title="编辑用户角色",this.ruleForm.title=e.title,this.ruleForm.rules=e.rules):(this.addOrEdit=-1,this.title="添加用户角色",this.ruleForm={title:"",rules:[]})},del:function(e){var t=this;this.$confirm("是否删除 "+e.title+" 这个角色").then(function(i){var s={id:e.id};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/delRole.html",s).then(function(e){1==e.status?(t.$message.success(e.msg),t.getRoleManage()):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}).catch(function(e){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(!i)return!1;t.loading2=!0;var s={title:t.ruleForm.title,rules:t.ruleForm.rules};-1!=t.addOrEdit?(s.id=t.addOrEdit,t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/editRole.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getRoleManage()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})):t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/addRole.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getRoleManage()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})})}},mounted:function(){this.$nextTick(function(){this.$emit("activeIndex","roleManage"),this.getRoleManage(),this.getAllRules(),sessionStorage.getItem("name")?this.$emit("nowPublic",sessionStorage.getItem("name")):this.$emit("nowPublic","暂时没有哦")})}},U={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:function(t){e.add(-1)}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加用户角色")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.roleManage,border:""}},[i("el-table-column",{attrs:{type:"index",width:"60",label:"ID"}}),e._v(" "),i("el-table-column",{key:"2",attrs:{prop:"title",label:"角色",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){e.add(t.row)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"640px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px","status-icon":""}},[i("el-form-item",{key:"1",attrs:{label:"角色名称",prop:"title"}},[i("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"选择权限"}},[i("el-checkbox-group",{attrs:{size:"small"},model:{value:e.ruleForm.rules,callback:function(t){e.$set(e.ruleForm,"rules",t)},expression:"ruleForm.rules"}},e._l(e.allRules,function(t){return i("el-checkbox",{key:t.id,attrs:{label:t.id,value:t.id,border:""}},[e._v(e._s(t.title))])}))],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var q=i("C7Lr")(L,U,!1,function(e){i("RaoP")},"data-v-5fae8676",null).exports,O={data:function(){return{systemUser:[],roleManage:[],loading:!0,loading2:!1,dialogVisible:!1,ruleForm:{username:"",password:"",id:"",newpassword:""},addOrEdit:-1,title:"",rules:{username:[{trigger:"blur",required:!0,message:"请输入用户名"}],password:[{trigger:"blur",required:!0,message:"请输入密码"}],id:[{trigger:"change",required:!0,message:"请选择角色"}]}}},methods:{getSystemUser:function(){var e=this;this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Userauth/index.html").then(function(t){e.loading=!1,1==t.status?e.systemUser=t.userlist:2==t.status?e.$router.push({name:"login",path:"/login"}):e.$message.error(t.msg)})},add:function(e){var t=this;this.dialogVisible=!0,-1!=e?(this.addOrEdit=e.userid,this.title="编辑系统用户",this.ruleForm.username=e.username,this.ruleForm.id=e.id,this.ruleForm.newpassword=""):(this.addOrEdit=-1,this.title="添加系统用户",this.ruleForm={username:"",password:"",id:""}),this.tools.getAxio("http://www.songphper.top"+this.tools.test+"/index/Userauth/getAllRole.html").then(function(e){t.loading=!1,1==e.status?t.roleManage=e.rolelist:2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})},submitForm:function(e){var t=this;this.$refs[e].validate(function(i){if(!i)return!1;t.loading2=!0;var s={username:t.ruleForm.username,role:t.ruleForm.id};-1!=t.addOrEdit?(s.id=t.addOrEdit,s.newpassword=t.ruleForm.newpassword,t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/editUser.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getSystemUser()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)})):(s.password=t.ruleForm.password,t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/addUser.html",s).then(function(i){t.loading2=!1,1==i.status?(t.$message.success(i.msg),t.$refs[e].resetFields(),t.dialogVisible=!1,t.getSystemUser()):2==i.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(i.msg)}))})},del:function(e){var t=this;this.$confirm("是否删除 "+e.username+" 这个用户").then(function(i){var s={id:e.userid};t.tools.getAxio("http://www.songphper.top"+t.tools.test+"/index/Userauth/delUser.html",s).then(function(e){1==e.status?(t.$message.success(e.msg),t.getSystemUser()):2==e.status?t.$router.push({name:"login",path:"/login"}):t.$message.error(e.msg)})}).catch(function(e){})}},mounted:function(){this.$nextTick(function(){this.$emit("activeIndex","systemUser"),this.getSystemUser(),sessionStorage.getItem("name")?this.$emit("nowPublic",sessionStorage.getItem("name")):this.$emit("nowPublic","暂时没有哦")})}},M={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"main"},[i("el-button",{staticClass:"addPublic",attrs:{type:"primary"},on:{click:function(t){e.add(-1)}}},[i("i",{staticClass:"el-icon-plus"}),e._v(" 添加系统用户")]),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.systemUser,border:""}},[i("el-table-column",{attrs:{type:"index",width:"60",label:"ID"}}),e._v(" "),i("el-table-column",{attrs:{prop:"username",label:"用户名",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{prop:"title",label:"角色",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"success",size:"middle"},on:{click:function(i){e.add(t.row)}}},[i("i",{staticClass:"el-icon-edit"})]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"middle"},on:{click:function(i){e.del(t.row)}}},[i("i",{staticClass:"el-icon-delete"})])]}}])})],1),e._v(" "),i("el-dialog",{attrs:{title:e.title,visible:e.dialogVisible,width:"640px",top:"5vh","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"120px","status-icon":""}},[i("el-form-item",{attrs:{label:"用户名",prop:"username"}},[i("el-input",{model:{value:e.ruleForm.username,callback:function(t){e.$set(e.ruleForm,"username",t)},expression:"ruleForm.username"}})],1),e._v(" "),-1==e.addOrEdit?i("el-form-item",{key:"-1",attrs:{label:"密码",prop:"password"}},[i("el-input",{model:{value:e.ruleForm.password,callback:function(t){e.$set(e.ruleForm,"password",t)},expression:"ruleForm.password"}})],1):i("el-form-item",{key:"1",attrs:{label:"新密码"}},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"需要更换密码填写，不需要不填写",placement:"bottom"}},[i("el-input",{model:{value:e.ruleForm.newpassword,callback:function(t){e.$set(e.ruleForm,"newpassword",t)},expression:"ruleForm.newpassword"}})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"角色",prop:"id"}},[i("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.ruleForm.id,callback:function(t){e.$set(e.ruleForm,"id",t)},expression:"ruleForm.id"}},e._l(e.roleManage,function(e){return i("el-option",{key:e.id,attrs:{label:e.title,value:e.id}})}))],1)],1),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],attrs:{type:"primary"},on:{click:function(t){e.submitForm("ruleForm")}}},[e._v("保 存")])],1)],1)],1)},staticRenderFns:[]};var z=i("C7Lr")(O,M,!1,function(e){i("hGFG")},"data-v-a6b5968a",null).exports;s.default.use(n.a),s.default.use(a.a),s.default.prototype.tools=c;var V=new a.a({routes:[{path:"/",name:"login",component:f},{path:"/login",name:"login",component:f},{path:"/main",name:"main",component:w,children:[{name:"configure",path:"/configure",component:F},{name:"menu",path:"/menu",component:I},{name:"autoReply",path:"/autoReply",component:S},{name:"customerService",path:"/customerService",component:A},{name:"roleManage",path:"/roleManage",component:q},{name:"systemUser",path:"/systemUser",component:z}]}]});s.default.config.productionTip=!1,new s.default({el:"#app",router:V,components:{App:r},template:"<App/>"})},RaoP:function(e,t){},VmZT:function(e,t){},X8XE:function(e,t){},asCa:function(e,t){},gfrq:function(e,t){},hGFG:function(e,t){},wOcD:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.8efba190a3b531cd102a.js.map